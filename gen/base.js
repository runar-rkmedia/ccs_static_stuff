!function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var a={};t.m=e,t.c=a,t.d=function(e,a,n){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=26)}([,,,function(e,t,a){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++){t=arguments[a];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var r=a(5);t.datepicker_default_options={locale:r.Norwegian,weekNumbers:!0,dateFormat:"Y-m-d",altInput:!0,altFormat:"j. F Y",minDate:new Date(1900,1,1),time_24hr:!0},t.datepicker=function(e,a){return void 0===a&&(a={}),flatpickr(e,n({},t.datepicker_default_options,a))},t.default={flatpickr:flatpickr,date:t.datepicker,range:function(e,a,r){void 0===a&&(a={});var i=a.dateFormat||"Y-m-d";return t.datepicker(e,n({onChange:function(e,t,a){if(r&&e.length){var n=flatpickr.formatDate(e[0],i);$(r[0]).val(n),$(r[1]).val(2===e.length?flatpickr.formatDate(e[1],i):n)}},altFormat:"d/m-y",mode:"range",dateFormat:i},a))},time:function(e,a){return void 0===a&&(a={}),t.datepicker(e,n({enableTime:!0,altInput:!1,dateFormat:"H:i",defaultHour:12,allowInput:!0,noCalendar:!0},a))},datetime:function(e,a){return void 0===a&&(a={}),t.datepicker(e,n({enableTime:!0,altFormat:"d. F Y, k\\l. H:i",dateFormat:"Y-m-d H:i:S",defaultHour:12,parseDate:function(e){return flatpickr.parseDate(e,"d.m.Y H:i")}},a))}}},,function(e,t,a){!function(e,a){a(t)}(0,function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},a={weekdays:{shorthand:["Søn","Man","Tir","Ons","Tor","Fre","Lør"],longhand:["Søndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lørdag"]},months:{shorthand:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Des"],longhand:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"]},firstDayOfWeek:1,rangeSeparator:" til ",weekAbbreviation:"Uke",scrollTitle:"Scroll for å endre",toggleTitle:"Klikk for å veksle",ordinal:function(){return"."}};t.l10ns.no=a;var n=t.l10ns;e.Norwegian=a,e.default=n,Object.defineProperty(e,"__esModule",{value:!0})})},,,,,,,,,,,,,function(e,t,a){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++){t=arguments[a];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var r=a(27),i=a(28),o=a(29),s=a(30),d=a(31),l=n({booking:r.default,slot_calendar:o.default,slot_calendar_internal:i.default,list_group_checked:s.default},d.default);t.default=l},,,,,,,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(18);window.carcare_func=n.default,a(32),XMLHttpRequest.prototype.open=function(e){return function(t,a,n,r,i){n||console.warn("xhr call: "+a+" isAsync: "+n),e.apply(this,arguments)}}(XMLHttpRequest.prototype.open)},function(e,t,a){"use strict";function n(e,t){for(var a=new Date(e.getTime()),n=new Date(t.getTime());a<=n;){if(0===a.getDay()||6===a.getDay())return!0;a=a.addDays(1)}return!1}function r(){$("#order_booking_form").ready(function(){$("#id_time_pickup").attr("placeholder","Nå / Ved bestilling");var e=$("#id_time_pickup").parent().parent();$("#id_has_self_transport").is(":checked")&&e.hide(),$("#id_has_self_transport").on("change",function(){$(this).is(":checked")?e.slideUp():e.slideDown()}),$("#id_has_self_transport").change(function(){$("#id_time_pickup").val("")});var t=$("#id_why_urgent").parent().parent(),a=$("#id_time_delivery").parent().parent();$("#id_is_urgent").is(":checked")||(t.hide(),a.hide()),$("#id_is_urgent").on("change",function(){$(this).is(":checked")?(t.slideDown(),a.slideDown()):(t.slideUp(),a.slideUp())});var n=$("#id_why_faulty").parent().parent();$("#id_is_faulty").is(":checked")||n.hide(),$("#id_is_faulty").on("change",function(){$(this).is(":checked")?n.slideDown():n.slideUp()});var r={},s={};$("#id_time_delivery").val()||(s.minDate=new Date,s.defaultDate=o(new Date,7)),$("#id_time_delivery").val()||(r.minDate=new Date,r.defaultDate=o(new Date,7)),i.default.datetime("#id_time_pickup",s),i.default.datetime("#id_time_delivery",r)})}Object.defineProperty(t,"__esModule",{value:!0});var i=a(3),o=function(e,t){return e.setDate(e.getDate()+t),e};window.weekendBetween=n,t.default=r},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){Date.prototype.addDays=function(e){var t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t},new Vue({el:"#slot-calendar-internal",template:"#slot-calendar-internal-template",data:{loading:!1,startDate:new Date,dealers:[],dealerId:null,orders:[]},created:function(){this.loadData()},methods:{close:function(){location.hash="",$("#orderData").empty(),$("#orderData").hide()},loadData:function(){this.loading=!0;var e=this;$.getJSON("/panel/dealers/json/",function(t){e.dealers=t,e.loading=!1}),this.loadCalendar()},loadCalendar:function(){this.loading=!0;var e=new Date(this.startDate.setHours(12)).toISOString().split("T")[0],t=this,a="?date="+e;this.dealerId&&(a=a+"&dealer="+this.dealerId),$.getJSON("/panel/orders/overview/slot-calendar-data/"+a,function(e){t.startDate=new Date(e.start_date),t.orders=e.orders,t.loading=!1})},dayDate:function(e){return this.startDate.addDays(e).getDate()+"."},previousWeek:function(){this.startDate=this.startDate.addDays(-6),this.loadData()},nextWeek:function(){this.startDate=this.startDate.addDays(8),this.loadData()}},watch:{dealerId:function(){this.loadCalendar()}},computed:{ordersByDate:function(){var e={};return this.orders.forEach(function(t){var a=t.time_delivery.split(" ")[0];e[a]||(e[a]=[]),t.time_delivery=new Date(t.time_delivery),e[a].push(t)}),e},hours:function(){for(var e=[],t=this,a=8;a<=16;a++)!function(a){for(var n=[],r=1;r<=7;r++){var i=t.startDate.addDays(r),o=i.toISOString().split("T")[0],s=t.ordersByDate[o];s?n.push(s.filter(function(e){return e.time_delivery.getHours()===a})):n.push([])}e.push(n)}(a);return e}}})}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){Date.prototype.addDays=function(e){var t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t},new Vue({el:"#slot-calendar",template:"#slot-calendar-template",data:{loading:!1,startDate:new Date,orders:[],moveOrder:null,moveTimes:[],moveExisting:null,moveTime:null,moveComment:null,moveStatus:null},created:function(){this.loadData()},methods:{loadData:function(){this.loading=!0;var e=this.startDate.toISOString().split("T")[0],t=this;$.getJSON("/ext/slot-calendar/?date="+e,function(e){t.startDate=new Date(e.start_date),t.orders=e.orders,t.loading=!1})},dayDate:function(e){return this.startDate.addDays(e).getDate()+"."},previousWeek:function(){this.startDate=this.startDate.addDays(-6),this.loadData()},nextWeek:function(){this.startDate=this.startDate.addDays(8),this.loadData()},move:function(e){if(!e.is_movable)return void alert("Kan ikke be om flytting av ordre bestilt av andre.");if("Levert"===e.status)return void alert("Kan ikke be om flytting av leverte ordre.");this.loading=!0,this.moveStatus=null,this.moveTimes=[],this.moveExisting=null,this.moveTime=null,this.moveComment=null,this.moveOrder=e;var t=this;$.getJSON("/ext/move-slots/"+e.id+"/",function(e){t.moveTimes=e.times,t.moveExisting=e.requested_move,t.loading=!1},function(){t.loading=!1})},saveMove:function(){if(this.moveOrder&&this.moveTime){this.loading=!0;var e=this;$.ajax("/ext/move-slot/"+this.moveOrder.id+"/",{data:JSON.stringify({time:this.moveTime,comment:this.moveComment}),contentType:"application/json",type:"POST"}).done(function(t){e.moveStatus=t.message,e.moveOrder=null,e.loading=!1}).fail(function(t){e.moveStatus=t,e.loading=!1})}}},computed:{ordersByDate:function(){var e={};return this.orders.forEach(function(t){var a=t.time_delivery.split(" ")[0];e[a]||(e[a]=[]),t.time_delivery=new Date(t.time_delivery),e[a].push(t)}),e},hours:function(){for(var e=[],t=this,a=8;a<=16;a++)!function(a){for(var n=[],r=1;r<=7;r++){var i=t.startDate.addDays(r),o=i.toISOString().split("T")[0],s=t.ordersByDate[o];s?n.push(s.filter(function(e){return e.time_delivery.getHours()===a})):n.push([])}e.push(n)}(a);return e}}})}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){$(".list-group.checked-list-box .list-group-item").each(function(){function t(){var e=n.is(":checked");a.data("state",e?"on":"off"),a.find(".state-icon").removeClass().addClass("state-icon "+o[a.data("state")].icon),e?a.addClass(i+r+" active"):a.removeClass(i+r+" active")}var a=$(this),n=a.find("input"),r=a.data("color")?a.data("color"):"primary",i="button"===a.data("style")?"btn-":"list-group-item-",o={on:{icon:"glyphicon glyphicon-check"},off:{icon:"glyphicon glyphicon-unchecked"}};a.css("cursor","pointer"),a.on("click",function(){n.prop("checked",!n.is(":checked")),n.triggerHandler("change"),t()}),n.on("change",function(){t(),e&&e()}),function(){!0===a.data("checked")&&n.prop("checked",!n.is(":checked")),t(),0===a.find(".state-icon").length&&a.prepend('<span class="state-icon '+o[a.data("state")].icon+'"></span>')}()})}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={},r=function(e){if("OK"===e.status){var t=e.results[0].geometry.location,a=t.lat,n=t.lng;if($("#id_map_lat").val(a),$("#id_map_lon").val(n),company_marker&&google_map){var r=new google.maps.LatLng(a,n);company_marker.setPosition(r),google_map.setCenter(r)}}},i={address:function(e){if(e){var t=e.street_name,a=e.post_code,n=e.post_area;return $("#id_address").val(t),$("#id_zip_code").val(a),$("#id_city").val(n),$(".length#id_map_lat").length&&s(),t}},company:function(e){if(e){var t=e.forretningsadresse||e.postadresse,a=t.adresse,n=t.postnummer,r=t.poststed;$("#id_address").val(a),$("#id_zip_code").val(n),$("#id_city").val(r),$("#id_org_number").val(e.organisasjonsnummer),$("#id_map_lat").length&&s()}return e.navn_title_case}},o=function(e,t,a){void 0===a&&(a={});var r={source:function(e,t){$.getJSON("/panel/json/customer/",$.extend(a,{query:e}),function(e){for(var a=[],r=0;r<e.length;r++){var i=e[r],o="cst"+i.id;a.push(o),n[o]=i}t(a)})},matcher:function(e){return!!this.query},displayText:function(e){var t=n[e];if(t){var a=t.cars;if(a){var r=a.join(", ");return"<span>"+t.name+"<br><small>"+r+"</small></span>"}return"<span>"+t.name+"</span>"}},minLength:1,updater:c(t)};e.typeahead($.extend(l,r))},s=_.debounce(function(){m($("#id_address").val(),$("#id_zip_code").val(),r)},500),d=function(e,t,a){void 0===t&&(t=i.address),void 0===a&&(a={}),$("#id_map_lat").length&&(s(),e.on("change paste keyup",s));var r={source:function(e,t){u(1,e,t)},minLength:1,updater:c(t),displayText:function(e){var t=n[e];if(t){var a=[t.post_code,t.post_area];return t.place&&t.place.toUpperCase()!==t.post_area&&a.push(t.place),"<span>"+t.street_name+"<br><small>"+a.join(", ")+"</small></span>"}return e}};e.typeahead($.extend(l,r))},l={minLength:2,items:25,delay:300,fitToElement:!1,highlighter:function(e){return e}},u=function(e,t,a){t=t.replace(/\s\d+\w?$/,"").trim(),$.getJSON("/api/address/",{street_name:t}).done(function(e){var t=[];if(e){for(var r=0;r<e.data.length;r++){var i=e.data[r],o="adr"+i.id;i.post_area=i.post_area.toUpperCase(),t.push(o),n[o]=i}a(t)}})},c=function(e){return function(t){return e(n[t],t)}},f=["Båt","og","Bil"],p=f.map(function(e){return e.toUpperCase()}),h=function(e,t){return t||(t=0),e.split(" ").map(function(e){var a=e.toUpperCase(),n=p.indexOf(a);return-1!==n?f[n]:a.length>t?a[0]+a.substr(1).toLowerCase():e}).join(" ")},m=function(e,t,a){$.getJSON("https://maps.googleapis.com/maps/api/geocode/json",{address:[e,t,"Norway"].join(", "),key:"AIzaSyAHO78I5BkyTl_JkE5G3OhtrYI3zxBhCbM"},a)},v=function(e,t){$.getJSON("https://data.brreg.no/enhetsregisteret/enhet.json?$filter=startswith(navn,'"+encodeURIComponent(e)+"')&size=10",function(e){var a=[];if(e.data){for(var r=0;r<e.data.length;r++){var i=e.data[r];i.navn_title_case=h(i.navn,3);var o=(i.forretningsadresse||i.postadresse,"org"+i.organisasjonsnummer);a.push(o),n[o]=i}t(a)}})},g=function(e,t,a){void 0===t&&(t=i.company);var r={source:function(e,t){a&&!a()||v(e,t)},updater:c(t),displayText:function(e){var t=n[e];if(t){var a=t.forretningsadresse||t.postadresse;return"<span>"+t.navn_title_case+"<br><small>"+[a.adresse,a.poststed].join(", ")+"</small></span>"}return e}};e.attr("autocomplete","off"),e.typeahead($.extend(l,r))};t.default={searchMap:n,toTitleCase:h,org_typeahead_source:v,addresses_typeahead_source:u,_updater:c,bind_customer_search:o,bind_address_search:d,bind_company_search:g,_typeahead_options:l}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(18),r=a(3);$(function(){$("body").on("click","a.confirm",function(e){if($(this).hasClass("disabled"))return!1;var t=$(e.target).data("message"),a='<div class="confirm-box"><p>'+t+'</p><a href="#" class="btn btn-sm btn-default box-cancel">Avbryt</a><a href="#" class="btn btn-sm btn-danger box-ok">OK</a></div>';$("body").append(a),e.preventDefault(),$(document).width()>2200&&$(".confirm-box").css({left:"25%"}),$(".box-cancel").on("click",function(){$(this).parent().remove()});var n=this;return $(".box-ok").on("click",function(){$(this).parent().remove(),window.location.assign($(n).attr("href"))}),!1}),$("body").on("click",".btn-print",function(e){window.print()}),n.default.bind_customer_search($(".quick_search"),function(e){e.url&&window.location.assign(e.url)},{cars:!0});var e=function(){r.default.date("input.datepicker-widget"),r.default.time("input.datepicker-widget-time"),r.default.range("input.datepicker-widget-range",{defaultDate:[$("#date-from").val(),$("#date-to").val()]},["#date-from","#date-to"])};e(),$("body").on("click",".modal-link",function(){if($(this).hasClass("disabled"))return!1;var t=$(".modal"),a=$(this).data("url");t.html("Laster..."),t.modal("show"),t.load(a,function(){e(),t.find(".form-async").ajaxForm({delegation:!0,target:".modal",success:function(){$.get(location.href,function(e){$(t.find(".form-async .alert.alert-success")[0]).length&&t.modal("hide"),$("#main").replaceWith($(e).filter("#main"))})}})})})})}]);